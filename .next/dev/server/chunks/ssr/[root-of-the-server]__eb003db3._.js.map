{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/lib/db-config.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/neon-http\";\r\nimport { neon } from \"@neondatabase/serverless\";\r\nimport {config} from 'dotenv';\r\n\r\nconfig({path: '.env.local'});\r\nconst client = neon(process.env.NEON_DATABASE_URL!);\r\nexport const db = drizzle(client);\r\n\r\nexport default db;"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,IAAA,+IAAM,EAAC;IAAC,MAAM;AAAY;AAC1B,MAAM,SAAS,IAAA,8JAAI,EAAC,QAAQ,GAAG,CAAC,iBAAiB;AAC1C,MAAM,KAAK,IAAA,mKAAO,EAAC;uCAEX"}},
    {"offset": {"line": 44, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/lib/db-schema.ts"],"sourcesContent":["import { pgTable, serial, text, vector, index } from \"drizzle-orm/pg-core\";\r\n\r\nexport const documents = pgTable(\r\n  \"documents\",\r\n  {\r\n    id: serial(\"id\").primaryKey(),\r\n    content: text(\"content\").notNull(),\r\n    embedding: vector(\"embedding\", { dimensions: 1536 }),\r\n  },\r\n  (table) => [\r\n    index(\"embeddingIndex\").using(\r\n      \"hnsw\",\r\n      table.embedding.op(\"vector_cosine_ops\")\r\n    ),\r\n  ]\r\n);\r\n\r\nexport type InsertDocument = typeof documents.$inferInsert;\r\nexport type SelectDocument = typeof documents.$inferSelect;"],"names":[],"mappings":";;;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,YAAY,IAAA,gKAAO,EAC9B,aACA;IACE,IAAI,IAAA,2KAAM,EAAC,MAAM,UAAU;IAC3B,SAAS,IAAA,uKAAI,EAAC,WAAW,OAAO;IAChC,WAAW,IAAA,+LAAM,EAAC,aAAa;QAAE,YAAY;IAAK;AACpD,GACA,CAAC,QAAU;QACT,IAAA,gKAAK,EAAC,kBAAkB,KAAK,CAC3B,QACA,MAAM,SAAS,CAAC,EAAE,CAAC;KAEtB"}},
    {"offset": {"line": 67, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/lib/embeddings.ts"],"sourcesContent":["import { embed, embedMany } from \"ai\";\r\nimport { createOpenRouter } from \"@openrouter/ai-sdk-provider\";\r\n\r\nconst openrouter = createOpenRouter({\r\n  apiKey: process.env.OPENROUTER_API_KEY!,  \r\n});\r\n\r\nexport async function genrateEmbeddings(text: string) {\r\n    const input = text.replace(\"\\n\", \" \");\r\n\r\n    const { embedding } = await embed({\r\n        model: openrouter.textEmbeddingModel(\"nvidia/nemotron-embed-6b:free\"),\r\n        value: input,\r\n    });\r\n    return embedding;\r\n}\r\n\r\nexport async function genrateEmbeddingsMany(texts: string[]) {\r\n    const inputs = texts.map((text) => text.replace(\"\\n\", \" \"));\r\n    const { embeddings } = await embedMany({\r\n        model: openrouter.textEmbeddingModel(\"nvidia/nemotron-embed-6b:free\"),\r\n        values: inputs,\r\n    });\r\n    return embeddings;\r\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEA,MAAM,aAAa,IAAA,2LAAgB,EAAC;IAClC,QAAQ,QAAQ,GAAG,CAAC,kBAAkB;AACxC;AAEO,eAAe,kBAAkB,IAAY;IAChD,MAAM,QAAQ,KAAK,OAAO,CAAC,MAAM;IAEjC,MAAM,EAAE,SAAS,EAAE,GAAG,MAAM,IAAA,6JAAK,EAAC;QAC9B,OAAO,WAAW,kBAAkB,CAAC;QACrC,OAAO;IACX;IACA,OAAO;AACX;AAEO,eAAe,sBAAsB,KAAe;IACvD,MAAM,SAAS,MAAM,GAAG,CAAC,CAAC,OAAS,KAAK,OAAO,CAAC,MAAM;IACtD,MAAM,EAAE,UAAU,EAAE,GAAG,MAAM,IAAA,iKAAS,EAAC;QACnC,OAAO,WAAW,kBAAkB,CAAC;QACrC,QAAQ;IACZ;IACA,OAAO;AACX"}},
    {"offset": {"line": 100, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/lib/chunking.ts"],"sourcesContent":["import { RecursiveCharacterTextSplitter } from \"@langchain/textsplitters\";\r\n\r\nexport const textSplitter = new RecursiveCharacterTextSplitter({\r\n    chunkSize: 150,\r\n    chunkOverlap: 20,\r\n    separators: [\"\"],\r\n});\r\n\r\nexport async function chunkcontent(content: string) {\r\n    return await textSplitter.splitText(content.trim());\r\n}"],"names":[],"mappings":";;;;;;AAAA;AAAA;;AAEO,MAAM,eAAe,IAAI,uMAA8B,CAAC;IAC3D,WAAW;IACX,cAAc;IACd,YAAY;QAAC;KAAG;AACpB;AAEO,eAAe,aAAa,OAAe;IAC9C,OAAO,MAAM,aAAa,SAAS,CAAC,QAAQ,IAAI;AACpD"}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/app/upload/pdf-reader.tsx"],"sourcesContent":["\"use server\";\r\n\r\nimport * as pdfjs from \"pdfjs-dist\";\r\nimport \"pdfjs-dist/build/pdf.worker.mjs\";\r\n\r\nexport async function extractPdfText(buffer: Buffer) {\r\n  const loadingTask = pdfjs.getDocument({ data: buffer });\r\n  const pdf = await loadingTask.promise;\r\n\r\n  let fullText = \"\";\r\n\r\n  for (let i = 1; i <= pdf.numPages; i++) {\r\n    const page = await pdf.getPage(i);\r\n    const textContent = await page.getTextContent();\r\n\r\n    const text = textContent.items.map((item: any) => item.str).join(\" \");\r\n    fullText += text + \"\\n\\n\";\r\n  }\r\n\r\n  return fullText;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAEO,eAAe,eAAe,MAAc;IACjD,MAAM,cAAc,6JAAiB,CAAC;QAAE,MAAM;IAAO;IACrD,MAAM,MAAM,MAAM,YAAY,OAAO;IAErC,IAAI,WAAW;IAEf,IAAK,IAAI,IAAI,GAAG,KAAK,IAAI,QAAQ,EAAE,IAAK;QACtC,MAAM,OAAO,MAAM,IAAI,OAAO,CAAC;QAC/B,MAAM,cAAc,MAAM,KAAK,cAAc;QAE7C,MAAM,OAAO,YAAY,KAAK,CAAC,GAAG,CAAC,CAAC,OAAc,KAAK,GAAG,EAAE,IAAI,CAAC;QACjE,YAAY,OAAO;IACrB;IAEA,OAAO;AACT;;;IAfsB;;AAAA,+OAAA"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/app/upload/actions.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { db } from \"@/lib/db-config\";\r\nimport { documents } from \"@/lib/db-schema\";\r\nimport { genrateEmbeddingsMany } from \"@/lib/embeddings\";\r\nimport { chunkcontent } from \"@/lib/chunking\";\r\nimport { extractPdfText } from \"./pdf-reader\"; // <-- your new file\r\n\r\nexport async function processpdfFile(formData: FormData) {\r\n  try {\r\n    const file = formData.get(\"pdf\") as File;\r\n    const buffer = Buffer.from(await file.arrayBuffer());\r\n\r\n    const text = await extractPdfText(buffer);\r\n\r\n    if (!text.trim()) {\r\n      return { success: false, error: \"No text found in PDF\" };\r\n    }\r\n\r\n    const chunks:any = chunkcontent(text);\r\n    const embeddings = await genrateEmbeddingsMany(chunks);\r\n\r\n    const record = chunks.map(({chunk, i}:any) => ({\r\n      content: chunk,\r\n      embedding: embeddings[i],\r\n    }));\r\n\r\n    await db.insert(documents).values(record);\r\n\r\n    return { success: true, message: \"PDF processed!\" };\r\n  } catch (err) {\r\n    console.error(\"Error processing PDF:\", err);\r\n    return { success: false, error: \"PDF processing failed\" };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA,wOAA+C,oBAAoB;;;;;;;;AAE5D,eAAe,eAAe,QAAkB;IACrD,IAAI;QACF,MAAM,OAAO,SAAS,GAAG,CAAC;QAC1B,MAAM,SAAS,OAAO,IAAI,CAAC,MAAM,KAAK,WAAW;QAEjD,MAAM,OAAO,MAAM,IAAA,wJAAc,EAAC;QAElC,IAAI,CAAC,KAAK,IAAI,IAAI;YAChB,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAuB;QACzD;QAEA,MAAM,SAAa,IAAA,sIAAY,EAAC;QAChC,MAAM,aAAa,MAAM,IAAA,iJAAqB,EAAC;QAE/C,MAAM,SAAS,OAAO,GAAG,CAAC,CAAC,EAAC,KAAK,EAAE,CAAC,EAAK,GAAK,CAAC;gBAC7C,SAAS;gBACT,WAAW,UAAU,CAAC,EAAE;YAC1B,CAAC;QAED,MAAM,gIAAE,CAAC,MAAM,CAAC,uIAAS,EAAE,MAAM,CAAC;QAElC,OAAO;YAAE,SAAS;YAAM,SAAS;QAAiB;IACpD,EAAE,OAAO,KAAK;QACZ,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO;YAAE,SAAS;YAAO,OAAO;QAAwB;IAC1D;AACF;;;IA1BsB;;AAAA,+OAAA"}}]
}