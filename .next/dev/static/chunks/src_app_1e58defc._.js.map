{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/app/component/Inputarea.tsx"],"sourcesContent":["import { Paperclip, Send, StopCircle, X } from 'lucide-react';\r\nimport React, { useRef, useState } from 'react'\r\nimport TextareaAutosize from \"react-textarea-autosize\";\r\n\r\ntype QuickActionType = 'ideas' | 'summarize' | 'explain';\r\n\r\nconst Inputarea = ({ isDarkMode, setInputMessage, inputMessage, isLoading, handleKeyPress, handleSendMessage, status, stop, setSelectedFiles, selectedFiles}: any) => {\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  const handleQuickAction = (action: QuickActionType) => {\r\n    const quickMessages: Record<QuickActionType, string> = {\r\n      ideas: \"Can you suggest some creative ideas for my project?\",\r\n      summarize: \"Please summarize the key points from our conversation.\",\r\n      explain: \"Can you explain how this AI assistant works?\"\r\n    };\r\n    \r\n    setInputMessage(quickMessages[action]);\r\n  };\r\n\r\n  const handleFileSelect = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const files = event.target.files;\r\n    if (files && files.length > 0) {\r\n      const newFiles = Array.from(files);\r\n      setSelectedFiles((prev:any) => [...prev, ...newFiles]);\r\n    }\r\n    // Reset input to allow selecting same file again\r\n    event.target.value = '';\r\n  };\r\n\r\n  const handleRemoveFile = (index: number) => {\r\n    setSelectedFiles((prev: File[]) => prev.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const handlePaperclipClick = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const getFileIcon = (file: File) => {\r\n    const fileType = file.type.split('/')[0];\r\n    switch (fileType) {\r\n      case 'image':\r\n        return 'üñºÔ∏è';\r\n      case 'video':\r\n        return 'üé¨';\r\n      case 'audio':\r\n        return 'üéµ';\r\n      case 'application':\r\n        if (file.type.includes('pdf')) return 'üìÑ';\r\n        if (file.type.includes('word') || file.type.includes('document')) return 'üìù';\r\n        if (file.type.includes('sheet') || file.type.includes('excel')) return 'üìä';\r\n        return 'üìé';\r\n      default:\r\n        return 'üìé';\r\n    }\r\n  };\r\n\r\n  const formatFileSize = (bytes: number) => {\r\n    if (bytes === 0) return '0 Bytes';\r\n    const k = 1024;\r\n    const sizes = ['Bytes', 'KB', 'MB'];\r\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\r\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\r\n  };\r\n\r\n  return (\r\n    <div className={`border-t px-4 py-4 backdrop-blur-sm transition-colors duration-300 ${isDarkMode ? 'bg-gray-800/95 border-gray-700' : 'bg-white/80 border-gray-200'}`}>\r\n      \r\n      {/* Selected Files Preview */}\r\n      {selectedFiles.length > 0 && (\r\n        <div className={`mb-4 p-3 rounded-lg border ${isDarkMode ? 'bg-gray-700/50 border-gray-600' : 'bg-gray-50 border-gray-200'}`}>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {selectedFiles.map((file: File, index: number) => (\r\n              <div \r\n                key={index}\r\n                className={`flex items-center px-3 py-2 rounded-lg border ${\r\n                  isDarkMode ? \"bg-gray-600 border-gray-500 text-gray-200\" : \"bg-white border-gray-300 text-gray-700\"\r\n                }`}\r\n              >\r\n                <span>{getFileIcon(file)}</span>\r\n                <div className=\"flex flex-col ml-2\">\r\n                  <span className=\"text-xs font-medium truncate\">{file.name}</span>\r\n                  <span className=\"text-xs text-gray-400\">{formatFileSize(file.size)}</span>\r\n                </div>\r\n                <button\r\n                  className=\"ml-2 p-1 rounded hover:bg-red-500/30\"\r\n                  onClick={() => handleRemoveFile(index)}\r\n                >\r\n                  <X size={15} color='red' />\r\n                </button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Quick Actions */}\r\n      <div className=\"flex flex-wrap gap-2 mb-4\">\r\n        <button onClick={() => handleQuickAction('ideas')} className={`px-4 py-2 text-xs font-medium rounded-full transition-all hover:scale-105 shadow-sm ${ isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-300 border border-gray-600' : 'bg-linear-to-r from-blue-100 to-purple-100 hover:from-blue-200 hover:to-purple-200 text-gray-700 border border-gray-300'}`} >\r\n          üí° Suggest ideas\r\n        </button>\r\n        <button onClick={() => handleQuickAction('summarize')} className={`px-4 py-2 text-xs font-medium rounded-full transition-all hover:scale-105 shadow-sm ${ isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-300 border border-gray-600'  : 'bg-linear-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 text-gray-700 border border-gray-300' }`} >\r\n          üìù Summarize\r\n        </button>\r\n        <button onClick={() => handleQuickAction('explain')} className={`px-4 py-2 text-xs font-medium rounded-full transition-all hover:scale-105 shadow-sm ${ isDarkMode ? 'bg-gray-700 hover:bg-gray-600 text-gray-300 border border-gray-600' : 'bg-linear-to-r from-pink-100 to-orange-100 hover:from-pink-200 hover:to-orange-200 text-gray-700 border border-gray-300'}`}>\r\n          üîç Explain\r\n        </button>\r\n      </div>\r\n\r\n      {/* Hidden File Input */}\r\n      <input type=\"file\" ref={fileInputRef} onChange={handleFileSelect} multiple accept=\"image/*,video/*,audio/*,.pdf,.doc,.docx,.txt,.xls,.xlsx\" className=\"hidden\" />\r\n\r\n      {/* Input Area */}\r\n      <div className=\"flex space-x-3\">\r\n        <div className=\"flex-1 relative\">\r\n            <TextareaAutosize value={inputMessage} onChange={(e) => setInputMessage(e.target.value)} onKeyDown={handleKeyPress} placeholder=\"Type your message...\" disabled={isLoading}\r\n            minRows={1} maxRows={5}\r\n                className={` w-full px-5 py-3 pr-12 resize-none rounded-2xl transition-all shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 ${isDarkMode \r\n                    ? 'bg-gray-700 border border-gray-600 text-white placeholder-gray-400'  : 'bg-white border border-gray-300 text-gray-800 placeholder-gray-500'}`}\r\n            />\r\n\r\n            <button type=\"button\" onClick={handlePaperclipClick} className={` absolute right-4 top-1/2 -translate-y-1/2 p-1 rounded-full transition-colors ${isDarkMode  ? \"text-gray-400 hover:text-gray-300 hover:bg-gray-600\"  : \"text-gray-400 hover:text-gray-600 hover:bg-gray-100\"}`}>\r\n                <Paperclip className=\"w-5 h-5\" />\r\n            </button>\r\n        </div>\r\n        {status === \"streaming\" || status === \"submitted\" ? (\r\n            <button onClick={stop} className=\"w-14 h-14 bg-linear-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 rounded-full flex items-center justify-center text-white transition-all shadow-lg hover:shadow-xl hover:scale-105 disabled:hover:scale-100\" >\r\n                <StopCircle className=\"w-5 h-5\" />\r\n            </button>\r\n        ) : (\r\n            <button onClick={handleSendMessage} disabled={isLoading} className=\"w-14 h-14 bg-linear-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed rounded-full flex items-center justify-center text-white transition-all shadow-lg hover:shadow-xl hover:scale-105 disabled:hover:scale-100\" >\r\n                <Send className=\"w-5 h-5\" />\r\n            </button>\r\n        )}\r\n      </div>\r\n      \r\n      {/* Footer Note */}\r\n      <div className=\"text-center mt-3\">\r\n        <p className={`text-xs ${isDarkMode ? 'text-gray-500' : 'text-gray-500'}`}>\r\n          AI assistant may produce inaccurate information\r\n        </p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Inputarea"],"names":[],"mappings":"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"}},
    {"offset": {"line": 312, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/app/upload/actions.ts"],"sourcesContent":["\"use server\";\r\n\r\nimport { pdfToText } from \"./pdf-reader\";\r\nimport { db } from \"@/lib/db-config\";\r\nimport { documents } from \"@/lib/db-schema\";\r\nimport { generateEmbeddingsMany } from \"@/lib/embeddings\";\r\nimport { chunkcontent } from \"@/lib/chunking\";\r\n\r\nexport async function processpdfFile(formData: FormData) {\r\n  try {\r\n    const file = formData.get(\"pdf\") as File;\r\n    const bytes = await file.arrayBuffer();\r\n    const uint8 = new Uint8Array(bytes);\r\n\r\n    const textOutput = await pdfToText(uint8);\r\n    const text = Array.isArray(textOutput) ? textOutput.join(\"\\n\") : textOutput;\r\n\r\n    if (!text || !text.trim()) {\r\n      return { success: false, error: \"No extractable text found.\" };\r\n    }\r\n\r\n    const rawChunks = await chunkcontent(text);\r\n    const chunks = Array.isArray(rawChunks) ? rawChunks : [rawChunks];\r\n\r\n    console.log(\"CHUNKS:\", chunks);\r\n\r\n    const embeddingResponse:any = await generateEmbeddingsMany(chunks);\r\n    console.log(\"EMBEDDINGS RESPONSE...:\", embeddingResponse);\r\n\r\n    const embedData = embeddingResponse.data;\r\n\r\n    await db.insert(documents).values(\r\n      chunks.map((chunk, index) => ({\r\n        content: chunk,\r\n        embedding: embedData[index].embedding,  \r\n      }))\r\n    );\r\n\r\n    return {\r\n      success: true,\r\n      message: \"PDF processed & stored successfully.\",\r\n    };\r\n  } catch (error) {\r\n    console.error(\"Error:\", error);\r\n    return { success: false, error: \"Failed to process PDF\" };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;IAQsB,iBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA"}},
    {"offset": {"line": 327, "column": 0}, "map": {"version":3,"sources":["file:///D:/Nxtjs/rag-chatbot/src/app/chat/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useChat } from \"@ai-sdk/react\";\r\nimport { useState, useRef, useEffect } from 'react';\r\nimport Inputarea from '../component/Inputarea';\r\nimport Codeblock from \"../component/Codeblock\";\r\nimport { useApp } from \"@/context/AppContext\";\r\nimport { getFileIcon, formatFileSize } from \"../component/Codeblock\";\r\nimport { processpdfFile } from \"../upload/actions\";\r\n\r\n// Helper to convert File to preview URL\r\nconst createFilePreview = (file: File) => {\r\n  return {\r\n    file,\r\n    preview: URL.createObjectURL(file),\r\n    name: file.name,\r\n    size: file.size,\r\n    type: file.type\r\n  };\r\n};\r\n\r\nexport default function ChatPage() {\r\n  const { messages, sendMessage, status, error, stop } = useChat();\r\n  const [msg, setMessages] = useState<any[]>([]);\r\n  const [inputMessage, setInputMessage] = useState('');\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const { isDarkMode, clearChatSignal } = useApp();\r\n  const messagesEndRef = useRef<HTMLDivElement>(null);\r\n  const [showError, setShowError] = useState(false);\r\n  const [selectedFiles, setSelectedFiles] = useState<any[]>([]);\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState('');\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  // Sync messages from useChat hook\r\n  useEffect(() => {\r\n    setMessages(\r\n      messages.map((m: any) => ({\r\n        id: m.id,\r\n        text: m.parts?.find((p: any) => p.type === \"text\")?.text || m.content || \"\",\r\n        files: m.parts?.filter((p: any) => p.type === \"file\").map((f: any) => f.file) || [],\r\n        isUser: m.role === \"user\",\r\n        timestamp: new Date(m.createdAt || Date.now()),\r\n      }))\r\n    );\r\n  }, [messages]);\r\n\r\n  // Error display handling\r\n  useEffect(() => {\r\n    if (error) {\r\n      setShowError(true);\r\n      const timer = setTimeout(() => {\r\n        setShowError(false);\r\n      }, 7000);\r\n      return () => clearTimeout(timer);\r\n    }\r\n  }, [error]);\r\n\r\n  // Clear chat on signal\r\n  useEffect(() => {\r\n    if (clearChatSignal) {\r\n      stop();\r\n      setMessages([]);\r\n      setInputMessage('');\r\n      setSelectedFiles([]);\r\n    }\r\n  }, [clearChatSignal, stop]);\r\n\r\n  // Auto-scroll to bottom\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [msg]);\r\n\r\n  // Cleanup file previews on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      msg.forEach(message => {\r\n        if (message.filePreview) {\r\n          message.filePreview.forEach((fp: any) => {\r\n            URL.revokeObjectURL(fp.preview);\r\n          });\r\n        }\r\n      });\r\n    };\r\n  }, [msg]);\r\n\r\n  const handleSendMessage = async () => {\r\n    const hasFiles = selectedFiles.length > 0;\r\n    const hasMessage = inputMessage.trim();\r\n\r\n    // Clear inputs immediately\r\n    const messageCopy = inputMessage;\r\n    const filesCopy = [...selectedFiles];\r\n    setInputMessage(\"\");\r\n    setSelectedFiles([]);\r\n\r\n    // ---- BOTH MESSAGE AND FILE ----\r\n    if (hasFiles && hasMessage) {\r\n      const file = filesCopy[0];\r\n      const filePreview = createFilePreview(file);\r\n\r\n      // 1Ô∏è‚É£ Show user message with file preview\r\n      const userMessage = {\r\n        id: `user-${Date.now()}`,\r\n        text: messageCopy,\r\n        files: [],\r\n        filePreview: [filePreview],\r\n        isUser: true,\r\n        timestamp: new Date(),\r\n      };\r\n      setMessages(prev => [...prev, userMessage]);\r\n\r\n      // 2Ô∏è‚É£ Send text message via AI\r\n      sendMessage({ text: messageCopy });\r\n\r\n      // 3Ô∏è‚É£ Upload file in background\r\n      setIsLoading(true);\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append(\"pdf\", file);\r\n        const result = await processpdfFile(formData);\r\n\r\n        // Show success/error notification\r\n        if (result.success) {\r\n          setSuccessMessage(result.message || \"PDF processed successfully!\");\r\n          setShowSuccess(true);\r\n          setTimeout(() => setShowSuccess(false), 2000);\r\n        } else {\r\n          setShowError(true);\r\n          setTimeout(() => setShowError(false), 2000);\r\n        }\r\n      } catch (err: any) {\r\n        setShowError(true);\r\n        setTimeout(() => setShowError(false), 2000);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // ---- ONLY FILE ----\r\n    if (hasFiles) {\r\n      const file = filesCopy[0];\r\n      const filePreview = createFilePreview(file);\r\n\r\n      // Show user message with file preview\r\n      const userMessage = {\r\n        id: `user-${Date.now()}`,\r\n        text: \"\",\r\n        files: [],\r\n        filePreview: [filePreview],\r\n        isUser: true,\r\n        timestamp: new Date(),\r\n      };\r\n      setMessages(prev => [...prev, userMessage]);\r\n\r\n      setIsLoading(true);\r\n      try {\r\n        const formData = new FormData();\r\n        formData.append(\"pdf\", file);\r\n        const result = await processpdfFile(formData);\r\n\r\n        // Show success notification first\r\n        if (result.success) {\r\n          setSuccessMessage(result.message || \"PDF uploaded successfully!\");\r\n          setShowSuccess(true);\r\n          setTimeout(() => setShowSuccess(false), 2000);\r\n\r\n          // Then show AI response if there's content\r\n          if (result.message && result.message !== \"PDF uploaded successfully!\") {\r\n            // Wait a moment before showing AI response\r\n            setTimeout(() => {\r\n              const aiMessage = {\r\n                id: `ai-${Date.now()}`,\r\n                text: result.message,\r\n                files: [],\r\n                filePreview: [],\r\n                isUser: false,\r\n                timestamp: new Date(),\r\n              };\r\n              setMessages(prev => [...prev, aiMessage]);\r\n            }, 500);\r\n          }\r\n        } else {\r\n          // Show error message if failed\r\n          const errorMessage = {\r\n            id: `error-${Date.now()}`,\r\n            text: `Error: ${result.error || \"Failed to process PDF\"}`,\r\n            files: [],\r\n            filePreview: [],\r\n            isUser: false,\r\n            timestamp: new Date(),\r\n          };\r\n          setMessages(prev => [...prev, errorMessage]);\r\n          setShowError(true);\r\n          setTimeout(() => setShowError(false), 2000);\r\n        }\r\n      } catch (err: any) {\r\n        const errorMessage = {\r\n          id: `error-${Date.now()}`,\r\n          text: `Error uploading file: ${err.message || \"Unknown error\"}`,\r\n          files: [],\r\n          filePreview: [],\r\n          isUser: false,\r\n          timestamp: new Date(),\r\n        };\r\n        setMessages(prev => [...prev, errorMessage]);\r\n        setShowError(true);\r\n        setTimeout(() => setShowError(false), 2000);\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n      return;\r\n    }\r\n\r\n    // ---- ONLY MESSAGE ----\r\n    if (hasMessage) {\r\n      sendMessage({ text: messageCopy });\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSendMessage();\r\n    }\r\n  };\r\n\r\n  const formatTime = (date: Date) => {\r\n    return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  };\r\n\r\n  return (\r\n    <div className={`flex flex-col h-[calc(100vh-4.5rem)] transition-colors duration-300 ${isDarkMode ? 'bg-gray-900' : 'bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50'}`}>\r\n\r\n      {/* Messages Area */}\r\n      <div className=\"flex-1 overflow-y-auto px-4 py-6 space-y-6 w-full items-center mx-auto\">\r\n\r\n        {/* Error Notification */}\r\n        {showError && (\r\n          <div className=\"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 animate-fade-in bg-red-500 text-white px-6 py-3 rounded-lg shadow-2xl flex items-center space-x-3\">\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\r\n            </svg>\r\n            <span className=\"font-medium\">{error?.message || \"Failed to process file\"}</span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Success Notification */}\r\n        {showSuccess && (\r\n          <div className=\"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 animate-fade-in bg-green-500 text-white px-6 py-3 rounded-lg shadow-2xl flex items-center space-x-3\">\r\n            <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M5 13l4 4L19 7\" />\r\n            </svg>\r\n            <span className=\"font-medium\">{successMessage}</span>\r\n          </div>\r\n        )}\r\n\r\n        \r\n        \r\n        {/* Loading Indicator */}\r\n        {(status === \"submitted\"|| status === \"streaming\" || isLoading) && (\r\n          <div className=\"flex items-start space-x-3 animate-fade-in\">\r\n            <div className=\"shrink-0 w-10 h-10 rounded-full bg-gradient-to-r from-purple-500 to-pink-500 flex items-center justify-center text-xs font-semibold text-white shadow-md\">\r\n              ü§ñ\r\n            </div>\r\n            <div className={`rounded-2xl rounded-bl-none px-5 py-4 shadow-md ${isDarkMode ? 'bg-gray-800 border border-gray-700' : 'bg-white border border-gray-200'}`}>\r\n              <div className=\"flex items-center space-x-3\">\r\n                {isLoading && (\r\n                  <div className={`flex items-center space-x-2 ${isDarkMode ? 'text-gray-300' : 'text-gray-600'}`}>\r\n                    <svg className=\"animate-spin h-4 w-4\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n                      <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\r\n                      <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                    </svg>\r\n                    <span className=\"text-sm\">Uploading file...</span>\r\n                  </div>\r\n                )}\r\n                {status === \"submitted\" && !isLoading && (\r\n                  <div className=\"flex space-x-1.5\">\r\n                    <div className={`w-2.5 h-2.5 rounded-full animate-bounce ${isDarkMode ? 'bg-gray-500' : 'bg-gray-400'}`}></div>\r\n                    <div className={`w-2.5 h-2.5 rounded-full animate-bounce ${isDarkMode ? 'bg-gray-500' : 'bg-gray-400'}`} style={{ animationDelay: '0.1s' }}></div>\r\n                    <div className={`w-2.5 h-2.5 rounded-full animate-bounce ${isDarkMode ? 'bg-gray-500' : 'bg-gray-400'}`} style={{ animationDelay: '0.2s' }}></div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {msg.length === 0 && (\r\n          <div className=\"flex flex-col items-center justify-center h-[60vh] px-4\">\r\n            <div className=\"relative mb-8\">\r\n              <div className={`w-24 h-24 rounded-2xl flex items-center justify-center shadow-2xl ${isDarkMode ? 'bg-gradient-to-br from-blue-600 to-purple-700 shadow-blue-500/20' : 'bg-gradient-to-br from-blue-500 to-purple-600 shadow-blue-500/30'}`}>\r\n                <div className=\"text-3xl\">ü§ñ</div>\r\n              </div>\r\n              <div className={`absolute inset-0 rounded-2xl ${isDarkMode ? 'bg-blue-500/20' : 'bg-blue-400/20'} animate-ping`}></div>\r\n            </div>\r\n\r\n            <div className=\"text-center mb-12\">\r\n              <h1 className={`text-4xl font-bold mb-4 bg-gradient-to-r ${isDarkMode ? 'from-blue-400 to-purple-400' : 'from-blue-600 to-purple-600'} bg-clip-text text-transparent`}>Welcome to AI Assistant</h1>\r\n              <p className={`text-lg max-w-md mx-auto ${isDarkMode ? 'text-gray-300' : 'text-gray-600'}`}>Your intelligent companion for answers, ideas, and creative solutions</p>\r\n            </div>\r\n\r\n            <div className=\"fixed top-1/4 left-1/4 opacity-10\">\r\n              <div className={`w-8 h-8 rounded-full ${isDarkMode ? 'bg-blue-400' : 'bg-blue-500'} animate-bounce`}></div>\r\n            </div>\r\n            <div className=\"fixed bottom-1/3 right-1/4 opacity-10\">\r\n              <div className={`w-6 h-6 rounded-full ${isDarkMode ? 'bg-purple-400' : 'bg-purple-500'} animate-bounce`} style={{ animationDelay: '0.5s' }}></div>\r\n            </div>\r\n          </div>\r\n        )}  \r\n        \r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Input Area */}\r\n      <Inputarea  \r\n        isDarkMode={isDarkMode}  \r\n        setInputMessage={setInputMessage}  \r\n        inputMessage={inputMessage}  \r\n        selectedFiles={selectedFiles}  \r\n        setSelectedFiles={setSelectedFiles}\r\n        handleKeyPress={handleKeyPress}  \r\n        handleSendMessage={handleSendMessage}  \r\n        status={status}  \r\n        stop={stop}  \r\n        isLoading={isLoading} \r\n      />\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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"}}]
}